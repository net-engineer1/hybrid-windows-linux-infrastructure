# Week 1: 
 - Проектирование инфраструктуры

## Цель 
Спроектировать тестовую гибридную инфраструктуру Windows + Linux без развертывания виртуальных машин.

## Планируемая инфраструктура

## Windows
- Windows Server (Domain Controller)
- Active Directory
- DNS
- DHCP

## Linux
- Ubuntu Server
- Участие в домене (позже)
- Сервисы мониторинга / автоматизации

## Сеть
- Внутренняя сеть
- Разделение ролей серверов
- Статические IP для серверов

## Почему сначала схема?
Перед развертыванием важно понимать:
- какие серверы будут
- какие роли они выполняют
- как они связаны между собой

## Логическая схема
```
                 [ Интернет ]
                      |
                [ NAT / Host ]
                      | 
------------------------------------------------
|                                              |
[ Windows Server ]             [ Ubuntu Server ]
(AD, DNS, DHCP)                (Monitoring, Scripts)
IP: 192.168.56.10               IP: 192.168.56.20
```

## NAT / Host
NAT в VirtualBox используется как сетевой шлюз для виртуальных машин.
Он позволяет серверам выходить в интернет через хостовую систему, при этом виртуальные машины не доступны напрямую из внешней сети

## Использование NAT:
- упрощает настройку сети
- повышает безопасность
- соответствует реальной корпоративной архитектуре, где серверы работают за шлюзом, а не напрямую в интернете

## Windows Server
Windows Server используется как центральный сервер управления инфраструктурой
Он явялется основой корпоративной сети и выполняет ключевые функции:

## Active Directory (AD) - централизованная служба управления объектами домена (пользователи, компьютеры, группы) отвечает за:
- Пользователей
- Компьютеры
- Группы
- Права
- Политики безопасности

- DNS - обеспечивает разрешение имен и является обязательным компонентом работы домена
- DHCP - автоматизирует выдачу сетевых параметров

## Без AD:
- Каждый компьютер сам по себе
- Пользователи неуправляемы
- Безопасности нет

## DNS - Без него AD не существует
- Active Directory физически не может работать без DNS
Почему?
- Домен - это имя, а не IP
- Сервисы  находят друг друга по DNS
- Клиенты ищут контроллер домена через DNS
- Если DNS работает неправильно, клиенты не могут найти домен, и работа AD нарушается
- DNS это указатель, без него компьютер просто не знает, в какую "дверь" постучаться, чтобы его пустили в сеть. 
- Если DNS не работает, клиенты не могут найти контроллер домена и другие сетевые сервисы.
В результате пользователи теряют доступ к корпоративным ресурсам
(почта, принтеры, файловые серверы), даже если серверы включены и
работают исправно.

```ДОМЕН: example.corp
|
|-- OU=Users
|-- OU=Computers
|-- OU=Sales
|     |-- Maria
|     |-- PC-Maria
|
|-- OU=Finance
|     |-- Users
|     |-- Computers
|
|-- OU=IT
```

## Без Windows Server невозможно построить управляемую и безопасную корпоративную инфраструктуру
Active Directory работает поверх DNS и использует его для обнаружения домена и служб



## Этап 1.  
### Подготовка Windows Server 2022

### Цель этапа
Подготовить Windows Server к дальнейшему развертыванию доменной инфраструктуры Active Directory

### На данном этапе выполняется:

- Настройка сетевых адаптеров
- Проверка IP-адресации
- Понимание роли NAT и Host-Only сети
- Проверка DNS и DHCP поведения

### Сетевая конфигурация сервера
Сервер использует два сетевых адаптера

### Адаптер 1 - NAT
Назначение: доступ сервера в интернет (обновления, пакеты, внешние ресурсы)

### Параметры:
- IP-адрес: автоматически (10.0.2.x)
- DHCP: включен
- Шлюз: 10.0.2.2
- DNS: выдается NAT (возможны 8.8.8.8 / 8.8.4.4)

ВАЖНО: Данный адаптер не используется для домена*

### Адаптер 2 - Host-Only
Назначение: внутренняя сеть между виртуальными машинами

Параметры:
- IP-адрес: 192.168.56.10 (статический)
- Маска: 255.255.255.0
- DNS: 192.168.56.10 (сервер)
- DHCP: отключен

Этот адаптер используется для:
- Active Directory
- DNS
- DHCP
- Доменной аутентификации

### Почему DNS указывает на самого себя
Контроллер домена обязан использовать собственный DNS-сервер, так как:
- AD использует DNS для поиска служб
- клиенты домена ищут контроллер через DNS
- внешний DNS (8.8.8.8) не знает о домене example.corp

### Проверка конфигурации
Для проверки использовалась команда:

```powershell
- ipconfig /all
```

Результат подтверждает:
- Корректное разделение NAT и Host-Only
- Наличие статического IP для внутренней сети
- Правильную подготовку сервера к установке AD DS
